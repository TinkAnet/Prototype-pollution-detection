{
  "total_snippets": 100,
  "analyzed_snippets": [
    {
      "repository": "cognizanthackathon10/Final_Commit_1",
      "file_path": "samples/js/app4.js",
      "url": "https://github.com/cognizanthackathon10/Final_Commit_1/blob/a34d4f9928decbc5961656baa1d76443dfab2262/samples/js/app4.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 1.0,
        "explanation": "The code merges user-controlled data parsed from JSON into an object without validating property names, allowing an attacker to manipulate the prototype chain by including properties like '__proto__'. This can lead to arbitrary property assignment on all objects, making it a serious security risk."
      }
    },
    {
      "repository": "hex2f/windevRant",
      "file_path": "vue.js",
      "url": "https://github.com/hex2f/windevRant/blob/b1ae83d5f421deb21ac313d0329ea505b71b611f/vue.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains a function `extend` that merges properties from one object to another without validating the property names. This allows an attacker to potentially overwrite prototype properties such as `__proto__`, leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "EleanorMao/FlexoCalendar.js",
      "file_path": "jq.js",
      "url": "https://github.com/EleanorMao/FlexoCalendar.js/blob/7e538f67156dd6bbe6caff3477ac649f4cc48a07/jq.js",
      "language": "javascript",
      "stars": 22,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains multiple instances of object merging and extending without proper validation of property names, particularly in the jQuery.extend function. This can allow an attacker to manipulate the prototype of objects, leading to potential security issues such as denial of service or arbitrary code execution."
      }
    },
    {
      "repository": "EGreg/Q.js",
      "file_path": "Q.js",
      "url": "https://github.com/EGreg/Q.js/blob/176452accd82e74630aedc48c6a90de725bb4129/Q.js",
      "language": "javascript",
      "stars": 158,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code contains multiple instances where user-controlled data is merged into objects without proper validation of property names, particularly in functions like Q.extend and Q.setObject. This allows an attacker to manipulate object properties such as __proto__, which can lead to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "devin87/Q.js",
      "file_path": "Q.js",
      "url": "https://github.com/devin87/Q.js/blob/c393a01eeb39acdae00a8606f826edb5bb961ea9/Q.js",
      "language": "javascript",
      "stars": 39,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'extend' function merges properties from the source object into the target object without validating the property names. This allows an attacker to manipulate the target object by providing a source object with properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "newslin-design/newslin-design.github.io",
      "file_path": "jq.js",
      "url": "https://github.com/newslin-design/newslin-design.github.io/blob/45f5d66692bb785ff72e66f0f481597b9d2e26f6/jq.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains a jQuery extend function that merges user-controlled data into objects without validating property names. This can lead to prototype pollution if an attacker can control the keys in the data being merged, particularly if they can set properties like '__proto__' or 'constructor'. The use of 'jQuery.extend' without proper checks allows for potential manipulation of the prototype chain."
      }
    },
    {
      "repository": "jscriptcoder/sandbox-architecture",
      "file_path": "src/sb.ts",
      "url": "https://github.com/jscriptcoder/sandbox-architecture/blob/be77faf401fd1d324d2bae7a6afb02bd295eff8f/src/sb.ts",
      "language": "typescript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code allows merging of properties from a user-controlled object into the target object without validating property names. This includes potentially dangerous properties like '__proto__', which could lead to prototype pollution if an attacker provides an object with such properties."
      }
    },
    {
      "repository": "codefornl/AfvalStoffenWeb",
      "file_path": "lib/o.js",
      "url": "https://github.com/codefornl/AfvalStoffenWeb/blob/6d572a7e30f1d055a520f8134eef0ab23ebffa75/lib/o.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 2,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains a merge function that merges user-provided configuration objects into the base configuration without validating property names. This allows an attacker to potentially overwrite prototype properties such as '__proto__', leading to prototype pollution. Specifically, the merge function does not check for dangerous properties before assigning them, making it susceptible to this type of vulnerability."
      }
    },
    {
      "repository": "SrMatheus2000/fixed-vuln-test",
      "file_path": "71.js",
      "url": "https://github.com/SrMatheus2000/fixed-vuln-test/blob/e8396e46641999b4b281cf3bfb4b14e38a2037a6/71.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 26,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The `merge` function allows user-controlled objects to be merged into the target object without validating property names. This includes potentially dangerous properties like '__proto__', which can lead to prototype pollution vulnerabilities. The code does not implement any safeguards against overwriting critical properties, making it susceptible to attacks that manipulate the prototype chain."
      }
    },
    {
      "repository": "gundb/gun",
      "file_path": "gun.js",
      "url": "https://github.com/gundb/gun/blob/0ee3229cff889ed940762444d4d6d4e98e11398d/gun.js",
      "language": "javascript",
      "stars": 85,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 26,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains a function 'Gun.obj.ify' that uses 'JSON.parse' on user-controlled data without validating the content. This can lead to prototype pollution if an attacker provides a payload that includes properties like '__proto__' or 'constructor', allowing them to manipulate the prototype of objects."
      }
    },
    {
      "repository": "hanshank/js-cardio-async",
      "file_path": "db.js",
      "url": "https://github.com/hanshank/js-cardio-async/blob/2c8f3fcdfe1b37ded03244dc3d4489ba13823462/db.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 26,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code merges user-controlled JSON data into an object without validating property names. This allows an attacker to potentially manipulate properties like __proto__, constructor, or prototype, leading to prototype pollution."
      }
    },
    {
      "repository": "marknutter/nux",
      "file_path": "nux.js",
      "url": "https://github.com/marknutter/nux/blob/794d5c782192b923b077589f5a3c17311a1e04ad/nux.js",
      "language": "javascript",
      "stars": 19,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 26,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains a function `fromJSWith` that merges user-controlled data (from JSON) into objects without validating property names. This can lead to prototype pollution if the user can control the keys in the input JSON, allowing them to set properties like '__proto__', 'constructor', or 'prototype' on objects."
      }
    },
    {
      "repository": "NikolaySuslov/livecodingspace",
      "file_path": "public/lib/gundb/gun.js",
      "url": "https://github.com/NikolaySuslov/livecodingspace/blob/c79d33f2bcdc5d97785c8c8b77611501e98a9c5c/public/lib/gundb/gun.js",
      "language": "javascript",
      "stars": 28,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 26,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.85,
        "explanation": "The code contains multiple instances where user-controlled data is merged into objects without proper validation, particularly in the use of JSON.parse and object manipulation functions. This can lead to prototype pollution, especially when properties like '__proto__' or 'constructor' can be set through user input."
      }
    },
    {
      "repository": "dumconstantin/ramdajs-presentation",
      "file_path": "fns.js",
      "url": "https://github.com/dumconstantin/ramdajs-presentation/blob/047365e3a37fba6e6668099cc2fe5f63d84e090f/fns.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 30,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'extend' function merges user-controlled data from 'iframe.dataset' into the 'aceConf' object without validating the property names. This can allow an attacker to manipulate properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "mya-org/mya.js",
      "file_path": "mya.js",
      "url": "https://github.com/mya-org/mya.js/blob/e91002ab290ea3ffc828277e30f5f47b74ca8724/mya.js",
      "language": "javascript",
      "stars": 4,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 30,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code allows user-controlled data to be assigned directly to the `globalData` object in the `set` function without validating the property names. This can lead to prototype pollution if a user sets a key that is a dangerous property like '__proto__'. Additionally, the `_clone` function does not validate keys when cloning objects, which can further exacerbate the risk."
      }
    },
    {
      "repository": "evolutio/minicurso_vuejs",
      "file_path": "vue.js",
      "url": "https://github.com/evolutio/minicurso_vuejs/blob/e28d5f8d4b28596d34b236b373dfcc9f84bdec00/vue.js",
      "language": "javascript",
      "stars": 15,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 30,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains functions that extend or merge objects without validating property names, particularly in the 'extend' and 'mergeData' functions. This allows user-controlled data to potentially overwrite properties like '__proto__', leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "cbrand125/js-cardio-async",
      "file_path": "db.js",
      "url": "https://github.com/cbrand125/js-cardio-async/blob/f5a78cddeed84315105facf3152c07ea95b365c8/db.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 30,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code uses JSON.parse on potentially untrusted JSON data read from files without validating the contents before merging it into the 'allData' object. This could allow an attacker to inject properties like '__proto__' or 'constructor', leading to prototype pollution."
      }
    },
    {
      "repository": "abudeebf/Spinoza-2.0",
      "file_path": "public/src/util.ts",
      "url": "https://github.com/abudeebf/Spinoza-2.0/blob/ba6261631a2db2573cad25f02af89ec073c9614f/public/src/util.ts",
      "language": "typescript",
      "stars": 4,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 30,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The merge function does not validate property names before assigning them to the new object. This allows user-controlled input to overwrite critical properties like __proto__, constructor, or prototype, leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "geocollections/flog2",
      "file_path": "src/helpers.js",
      "url": "https://github.com/geocollections/flog2/blob/28e00c97a8a1d96541da1349b65e2f52cb60c814/src/helpers.js",
      "language": "javascript",
      "stars": 3,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        }
      ],
      "vulnerability_count": 34,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code uses a loop to extend the prototype of an object without validating the property names. If user-controlled data is passed to the `sub` object, it could allow an attacker to manipulate properties like `__proto__`, leading to prototype pollution."
      }
    },
    {
      "repository": "ship-components/ship-components-utility",
      "file_path": "src/utils.js",
      "url": "https://github.com/ship-components/ship-components-utility/blob/d37de9d916fa21921d6814c097eed8353a2d1545/src/utils.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 35,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The mergeDeep function merges properties from the source object into the target object without validating the keys. If a user-controlled source object is passed in, it can contain keys like '__proto__', which can lead to prototype pollution by altering the prototype of objects in the JavaScript environment."
      }
    },
    {
      "repository": "tanben/policy-checker",
      "file_path": "lib/utils.js",
      "url": "https://github.com/tanben/policy-checker/blob/65062f589fa9ea507dbd5b205133c6e4e6556bb4/lib/utils.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 36,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function merges properties from two objects without validating the keys. If an attacker provides an object with keys like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution, allowing them to modify the prototype of built-in objects."
      }
    },
    {
      "repository": "dwhalen/linearKittens",
      "file_path": "deepCopy.js",
      "url": "https://github.com/dwhalen/linearKittens/blob/51d5184d374693b1eea2cd257ca8517959687ebb/deepCopy.js",
      "language": "javascript",
      "stars": 11,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 36,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code allows user-controlled data to be merged into objects without proper validation of property names. Specifically, the `populate` method in the generic DeepCopier registers properties directly from the source object into the result object, which can include dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "Prendus/escodegen-es-module",
      "file_path": "escodegen.js",
      "url": "https://github.com/Prendus/escodegen-es-module/blob/7227c6ab5cf782ffd685bbbdcd04e020c1139e63/escodegen.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 36,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'extend' function merges properties from one object to another without validating the property names. This can lead to prototype pollution if user-controlled data is passed to it, allowing an attacker to modify the prototype of built-in objects by setting properties like '__proto__'."
      }
    },
    {
      "repository": "ghatchue/deep-copy-ts",
      "file_path": "src/deepCopy.ts",
      "url": "https://github.com/ghatchue/deep-copy-ts/blob/21f4fc55fa859dc868ff62905acaed6f97d0d141/src/deepCopy.ts",
      "language": "typescript",
      "stars": 6,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 36,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code allows for the assignment of the target object to the prototype of the Clone constructor. This means that if a user provides a malicious object, they can manipulate the prototype chain, potentially leading to prototype pollution. For example, if the target object contains properties like '__proto__', it could overwrite or modify the prototype of all objects."
      }
    },
    {
      "repository": "NKPmedia/kv-diagram-website",
      "file_path": "src/app/deepCopy.ts",
      "url": "https://github.com/NKPmedia/kv-diagram-website/blob/e4ceefea76db3ececa0e6634e0d5ad8494fb61e0/src/app/deepCopy.ts",
      "language": "typescript",
      "stars": 4,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 36,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'clone' function uses a constructor function to create a new object with its prototype set to the target object. This allows for the potential assignment of properties to the prototype of the target object, including dangerous properties like '__proto__' or 'constructor', leading to prototype pollution."
      }
    },
    {
      "repository": "nanw1103/otherlib",
      "file_path": "index.js",
      "url": "https://github.com/nanw1103/otherlib/blob/e0dfdd0b145dc8a2e9ba649097ccf2740eed2325/index.js",
      "language": "javascript",
      "stars": 2,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 37,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The deepMerge function merges properties from user-controlled sources into the target object without validating property names. This allows an attacker to manipulate the properties of the target object, including dangerous properties like __proto__, leading to prototype pollution."
      }
    },
    {
      "repository": "zowe/explorer-ip",
      "file_path": "webClient/webpack.config.js",
      "url": "https://github.com/zowe/explorer-ip/blob/9bf767db504bdcdacb37f35a85fe287e0c333303/webClient/webpack.config.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 38,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The deepMerge function merges properties from the 'extension' object into the 'base' object without validating the property names. This allows an attacker to control the keys being merged, including dangerous properties like '__proto__', which can lead to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "aiswarm/orchestrator",
      "file_path": "src/configParser.js",
      "url": "https://github.com/aiswarm/orchestrator/blob/95c468a97188efebe06dd3bd5441fb98cbe41994/src/configParser.js",
      "language": "javascript",
      "stars": 2,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 38,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges objects without validating property names, which can lead to prototype pollution if user-controlled data is passed in. Specifically, if an object with properties like '__proto__' is merged, it can manipulate the prototype of objects, leading to potential security issues."
      }
    },
    {
      "repository": "michael-benin-CN/gifshot",
      "file_path": "build/gifshot.js",
      "url": "https://github.com/michael-benin-CN/gifshot/blob/d190c923dd50eb49c733b2fcdef2b8ddc7ef1785/build/gifshot.js",
      "language": "javascript",
      "stars": 18,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 38,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function 'mergeOptions' merges user-controlled options into default options without validating property names. This allows an attacker to potentially set properties like '__proto__', leading to prototype pollution. The use of 'Object.keys' and direct assignments to the merged object without checks makes it vulnerable."
      }
    },
    {
      "repository": "Lnmix/lnmx-utils",
      "file_path": "lib/object.js",
      "url": "https://github.com/Lnmix/lnmx-utils/blob/b46efcd4833de38ea8885e33c2be93d05a559bcb/lib/object.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 39,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The `clone` function does not validate property names when copying properties from the source object to the target object. This means that if a user-controlled object is passed to this function, it could potentially allow for the assignment of dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "gyovannyvpn123/wailey-whatsapp-lib",
      "file_path": "lib/Utils/generics.js",
      "url": "https://github.com/gyovannyvpn123/wailey-whatsapp-lib/blob/6dd12a3204a178745f8ac747358bc0ef689f8d92/lib/Utils/generics.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 40,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'deepMerge' function merges properties from the 'source' object into the 'target' object without validating the property names. This allows an attacker to manipulate the 'source' object to include properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "tajulkhan/js-practice",
      "file_path": "js-dsa.js",
      "url": "https://github.com/tajulkhan/js-practice/blob/85f74e61d24f08dcd9de8b58b5401fc153a848a4/js-dsa.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 41,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'deepMerge' function does not validate property names before merging the 'source' object into the 'target' object. This allows an attacker to manipulate the 'source' object to include properties like '__proto__', which can lead to prototype pollution. For example, if an attacker provides a source object like { '__proto__': { 'polluted': 'value' } }, it would modify the prototype of all objects, potentially leading to severe security issues."
      }
    },
    {
      "repository": "cheelvisionofficial/100javascriptinterviewquestions",
      "file_path": "mergemultipleobjects.js",
      "url": "https://github.com/cheelvisionofficial/100javascriptinterviewquestions/blob/584f9af708bacc0cdcb3438f73806134edefdd3a/mergemultipleobjects.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 43,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The 'deepMerge' function merges objects without validating property names, allowing user-controlled input to overwrite properties like '__proto__', 'constructor', or 'prototype'. This can lead to prototype pollution, as malicious input can manipulate the prototype chain."
      }
    },
    {
      "repository": "TechnologicalJerry/javascript-programming-methods",
      "file_path": "object-methods.js",
      "url": "https://github.com/TechnologicalJerry/javascript-programming-methods/blob/a03b2762534f6fb9c61a062520bd5119b4bf58a2/object-methods.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 44,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The deepMerge function merges properties from the source object into the target object without validating property names. This allows an attacker to manipulate the source object to include properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "softaccel/apiator.js",
      "file_path": "apiator.js",
      "url": "https://github.com/softaccel/apiator.js/blob/8129b38ce1a575f2c8c153e4f6aef6675792064c/apiator.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 44,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code uses Object.assign to merge user-controlled data into objects without validating property names. Specifically, the use of Object.assign in the parseOptions function and deepmerge function could allow an attacker to manipulate the prototype of objects by providing properties like '__proto__', 'constructor', or 'prototype' in the opts or data attributes, leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "jongrantwritescode/standards_ui",
      "file_path": "src/init.js",
      "url": "https://github.com/jongrantwritescode/standards_ui/blob/1937033c9fb9b4c338f27a477ff791e72b85c486/src/init.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 45,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code merges user-controlled objects into the result object without validating the property names. This allows an attacker to set properties like '__proto__', which can lead to prototype pollution. Specifically, if a user passes an object with a key '__proto__' or similar dangerous keys, it can modify the prototype of all objects, leading to potential security issues."
      }
    },
    {
      "repository": "vsergione/csv-api",
      "file_path": "apiator.js",
      "url": "https://github.com/vsergione/csv-api/blob/f36dad856ae20e7052033269b9a8b86da29aa807/apiator.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 45,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code uses `Object.assign` to merge user-controlled data into objects without validating property names. This can allow an attacker to manipulate properties like `__proto__`, leading to prototype pollution vulnerabilities. Specifically, the `parseOptions` function does not sanitize input before merging, and the `deepmerge` function can also lead to unsafe merging of objects."
      }
    },
    {
      "repository": "crmtogether/Sage100Objects",
      "file_path": "Sage100Objects.js",
      "url": "https://github.com/crmtogether/Sage100Objects/blob/dc8fb69802ea78453ff32ba7ed46e6be12105b2d/Sage100Objects.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 46,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The deepMerge function does not validate property names before merging, allowing user-controlled input to overwrite properties like __proto__, constructor, or prototype. This can lead to prototype pollution, as malicious users can manipulate the input object to modify the prototype of built-in objects."
      }
    },
    {
      "repository": "OscarGodson/EpicEditor",
      "file_path": "src/editor.js",
      "url": "https://github.com/OscarGodson/EpicEditor/blob/dca5c97daf3273c86a4332105ebb05bc2220c3db/src/editor.js",
      "language": "javascript",
      "stars": 4232,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 46,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function _mergeObjs allows merging of user-controlled objects into the target object without validating property names. This includes the potential for properties like __proto__, constructor, or prototype to be set, leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "HesusG/doctorate-grading",
      "file_path": "js/utils/filesystem-manager.js",
      "url": "https://github.com/HesusG/doctorate-grading/blob/4f2aa1ebe4ffc465efed7d793d4b2ba64a5e943e/js/utils/filesystem-manager.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 46,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code merges objects without validating property names, allowing user-controlled data to overwrite dangerous properties like __proto__, constructor, or prototype. This can lead to prototype pollution, as malicious input can manipulate the prototype chain."
      }
    },
    {
      "repository": "pltnkv/cerebral-umd",
      "file_path": "build/cerebralBaobab.js",
      "url": "https://github.com/pltnkv/cerebral-umd/blob/87889737b3091993b5a1f3fcb92e99f8bc0a78dd/build/cerebralBaobab.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 46,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function 'deepmerge' merges user-controlled data into objects without validating property names, which can lead to prototype pollution. Specifically, if an attacker can control the 'newState' parameter in the 'import' method, they could potentially set properties like '__proto__' on the target object, allowing for prototype manipulation."
      }
    },
    {
      "repository": "raohmaru/rtkjs",
      "file_path": "lib/object.js",
      "url": "https://github.com/raohmaru/rtkjs/blob/08278a8f568ae875e088349f13364b2184dfaa93/lib/object.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        }
      ],
      "vulnerability_count": 47,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function deepMerge merges properties from obj2 into obj1 without validating the property names. This allows for the possibility of malicious input that can set dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "vega/vega-lite",
      "file_path": "src/util.ts",
      "url": "https://github.com/vega/vega-lite/blob/e7f55118e7c149c42436c800d053423cdd10bb1a/src/util.ts",
      "language": "typescript",
      "stars": 5120,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        }
      ],
      "vulnerability_count": 47,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function 'deepMerge_' merges properties from the source object into the destination object without validating the property names. This includes potentially dangerous properties like '__proto__', which can lead to prototype pollution. If user-controlled data is passed to 'mergeDeep', it can manipulate the prototype of objects, allowing for malicious behavior."
      }
    },
    {
      "repository": "dvdgatik/Vue",
      "file_path": "vue.js",
      "url": "https://github.com/dvdgatik/Vue/blob/b5f2aab2d8b88ce33d3e3a7e23bb1c1f8858a792/vue.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        }
      ],
      "vulnerability_count": 47,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code contains several instances where user-controlled data is merged into objects without proper validation, particularly in the `set` and `mergeData` functions. This allows an attacker to manipulate object properties, potentially leading to prototype pollution through direct assignments to properties like '__proto__' or through recursive merges that do not validate property names."
      }
    },
    {
      "repository": "Aktyn/js-utils",
      "file_path": "utils.ts",
      "url": "https://github.com/Aktyn/js-utils/blob/973c8ee03b37450c417acd1bd175efd2797d8cc7/utils.ts",
      "language": "typescript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        }
      ],
      "vulnerability_count": 47,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code uses 'smartArrayExtend' to extend an array of HTMLElement objects with methods from the 'extender' object. If 'extender' contains properties that are not validated, such as '__proto__', 'constructor', or 'prototype', it could lead to prototype pollution. The lack of checks for property names before assignment increases the risk of malicious input affecting the prototype chain."
      }
    },
    {
      "repository": "step1profit/r.js",
      "file_path": "r.js",
      "url": "https://github.com/step1profit/r.js/blob/93c1a061559d011ce42e94716aeb95fd50733721/r.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        }
      ],
      "vulnerability_count": 47,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The _merge function merges two objects without validating property names, allowing user-controlled input to overwrite properties like __proto__, potentially leading to prototype pollution. This is a critical vulnerability as it can compromise the integrity of the entire JavaScript environment."
      }
    },
    {
      "repository": "zhaoyingjun/TensorFlow-Coding",
      "file_path": "lessonNine/image-videoInstanceMaskApp/via-via-2.0.5/via.js",
      "url": "https://github.com/zhaoyingjun/TensorFlow-Coding/blob/1ff292e5d659aa98e7bf6d9cc3986ef07ac2ca81/lessonNine/image-videoInstanceMaskApp/via-via-2.0.5/via.js",
      "language": "javascript",
      "stars": 112,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code iterates over properties of user-controlled objects (r0.shape_attributes and r0.region_attributes) and assigns them directly to a new object (r1.shape_attributes and r1.region_attributes) without validating the property names. This could allow an attacker to manipulate the prototype of the object by including properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "dnv-opensource/playwright-live-recorder",
      "file_path": "src/main.ts",
      "url": "https://github.com/dnv-opensource/playwright-live-recorder/blob/6401f5b309bff0009c2a96c3c790856af6abe601/src/main.ts",
      "language": "typescript",
      "stars": 42,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The use of _.merge() from lodash without validating property names can lead to prototype pollution if user-controlled data is merged into the target object. If 'configFromFile' or 'configOverrides' contains keys like '__proto__', it can overwrite properties on Object.prototype, leading to potential security issues."
      }
    },
    {
      "repository": "pkmn/dmg",
      "file_path": "src/utils.ts",
      "url": "https://github.com/pkmn/dmg/blob/5e3b785aac75cc9811fc4e31b9563af4dba45bf8/src/utils.ts",
      "language": "typescript",
      "stars": 10,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'extend' function merges objects without validating property names, which can allow user-controlled data to overwrite prototype properties like '__proto__' or 'constructor'. This is a classic case of prototype pollution vulnerability."
      }
    },
    {
      "repository": "Ekliptor/apputils",
      "file_path": "objects.ts",
      "url": "https://github.com/Ekliptor/apputils/blob/ce207003c6dc94794ed5b376c79d773ce2802cb4/objects.ts",
      "language": "typescript",
      "stars": 2,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function 'mergeNumberObjects' merges properties from user-controlled objects into a new object without validating property names. This allows an attacker to potentially overwrite properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "vishalmeena2211/js-utils-funtions",
      "file_path": "js-imp/index.js",
      "url": "https://github.com/vishalmeena2211/js-utils-funtions/blob/7ff381cfd6db83e413b64bf54372258059b961e2/js-imp/index.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges objects deeply without validating property names, which can lead to prototype pollution if user-controlled data is passed in. Specifically, if an object with properties like '__proto__' or 'constructor' is merged, it can manipulate the prototype chain of objects."
      }
    },
    {
      "repository": "Marcusvgry/IntentionalesVergessenTeil1",
      "file_path": "js/jspsych.js",
      "url": "https://github.com/Marcusvgry/IntentionalesVergessenTeil1/blob/81ca69376b0b90b4fed94e65d7407438a357c1ee/js/jspsych.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code merges properties from obj1 and obj2 into a new object without validating property names. If user-controlled data is passed to obj1 or obj2, it could allow for the assignment of dangerous properties like __proto__, leading to prototype pollution."
      }
    },
    {
      "repository": "DefinitelyTyped/DefinitelyTyped",
      "file_path": "types/jsprim/index.d.ts",
      "url": "https://github.com/DefinitelyTyped/DefinitelyTyped/blob/86f44b5ee78b2ea5c25b8deb9f6f5d846042cf56/types/jsprim/index.d.ts",
      "language": "typescript",
      "stars": 50658,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function 'mergeObjects' appears to merge objects without validating property names, which could allow user-controlled input to modify prototype properties like '__proto__', 'constructor', or 'prototype'. If the function is called with untrusted data, it could lead to prototype pollution."
      }
    },
    {
      "repository": "tiddly-gittly/TW5-Typed",
      "file_path": "src/modules/utils/utils.d.ts",
      "url": "https://github.com/tiddly-gittly/TW5-Typed/blob/8ca278d09d3b9a13b8c8ea0df3540659d0015c16/src/modules/utils/utils.d.ts",
      "language": "typescript",
      "stars": 13,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The presence of the 'extend' and 'extendDeepCopy' functions suggests that user-controlled data may be merged into objects without proper validation of property names. If these functions do not sanitize or validate the properties being merged, it could allow an attacker to manipulate the prototype of an object, leading to prototype pollution."
      }
    },
    {
      "repository": "mindhivefi/ts-mock-firebase",
      "file_path": "src/utils/deepCopy.ts",
      "url": "https://github.com/mindhivefi/ts-mock-firebase/blob/cfbb3a2baf1f20914835e5a109403bed548a3f7c/src/utils/deepCopy.ts",
      "language": "typescript",
      "stars": 25,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function deepExtend does not validate property names when merging objects, which can lead to prototype pollution if user-controlled data is passed as the source. Specifically, if the source object contains properties like __proto__, constructor, or prototype, they can be assigned to the target object, potentially allowing an attacker to manipulate the prototype chain."
      }
    },
    {
      "repository": "GoogleCloudPlatform/iap-gcip-web-toolkit",
      "file_path": "authui-container/common/deep-copy.ts",
      "url": "https://github.com/GoogleCloudPlatform/iap-gcip-web-toolkit/blob/08cc003393d190ec2b07cdd31388bca110f5034d/authui-container/common/deep-copy.ts",
      "language": "typescript",
      "stars": 63,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function deepExtend does not validate property names before copying properties from the source object to the target object. This can allow an attacker to manipulate the source object to include dangerous properties like __proto__, which can lead to prototype pollution."
      }
    },
    {
      "repository": "apache/myfaces",
      "file_path": "api/src/client/typescript/mona_dish/AssocArray.ts",
      "url": "https://github.com/apache/myfaces/blob/d8f9fcc9da04f50c3a3543b69951d782dd0d6e00/api/src/client/typescript/mona_dish/AssocArray.ts",
      "language": "typescript",
      "stars": 125,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The `shallowMerge` function merges user-controlled associative arrays into a target object without validating property names. This allows an attacker to potentially set properties like '__proto__', leading to prototype pollution. The use of `JSON.parse(JSON.stringify(...))` in `deepCopy` can also be exploited if the input is not sanitized, allowing for manipulation of the prototype chain."
      }
    },
    {
      "repository": "datdevs/solidjs-iap-gcip-web",
      "file_path": "src/utils/index.ts",
      "url": "https://github.com/datdevs/solidjs-iap-gcip-web/blob/7540fa5d576ceb50f7ef5e44e6e86ae48dc5ff7d/src/utils/index.ts",
      "language": "typescript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function deepExtend merges properties from the source object into the target without validating property names. If the source object contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution, allowing an attacker to manipulate the prototype of built-in objects."
      }
    },
    {
      "repository": "friuns2/appforge",
      "file_path": "src/utils.js",
      "url": "https://github.com/friuns2/appforge/blob/048bd4564bb956913aadeb6d5eac674cbc105271/src/utils.js",
      "language": "javascript",
      "stars": 91,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges properties from the 'source' object into the 'target' object without validating the property names. If 'source' contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution, allowing an attacker to manipulate the prototype of built-in objects."
      }
    },
    {
      "repository": "microsoft/applicationinsights-react-js",
      "file_path": "gruntfile.js",
      "url": "https://github.com/microsoft/applicationinsights-react-js/blob/2292faffafd52ba8a8335722473b9fb026bbd92c/gruntfile.js",
      "language": "javascript",
      "stars": 42,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function uses 'Object.assign' and recursively merges objects without validating property names, which can allow user-controlled data to overwrite properties like '__proto__', leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "ShadowCloneLabs/GlutamateMCPServers",
      "file_path": "src/puppeteer/index.ts",
      "url": "https://github.com/ShadowCloneLabs/GlutamateMCPServers/blob/e2de73280b01e5d943593dd1aa2c01c5b9112f78/src/puppeteer/index.ts",
      "language": "javascript",
      "stars": 12,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The deepMerge function uses Object.assign to merge objects without validating property names, which can lead to prototype pollution if user-controlled data is passed as the source object. If the source object contains properties like '__proto__', it can modify the prototype of all objects, leading to potential security issues."
      }
    },
    {
      "repository": "doc-detective/resolver",
      "file_path": "src/config.js",
      "url": "https://github.com/doc-detective/resolver/blob/06d2cdf4156daeee4c527b4444006f68f2fd9e2d/src/config.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The `deepMerge` function merges properties from the `override` object into the `target` object without validating property names. If a user provides an object with properties like '__proto__', it can lead to prototype pollution, allowing the attacker to modify the prototype of native objects."
      }
    },
    {
      "repository": "mk24agm/bcs-webdev-internship",
      "file_path": "docs/js/script.js",
      "url": "https://github.com/mk24agm/bcs-webdev-internship/blob/3d09690aacde94589725e8bb4b3213d657101dd1/docs/js/script.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The `deepMerge` function merges objects without validating property names, allowing user-controlled data (from `SITE_DATA`) to overwrite sensitive properties like `__proto__`, `constructor`, or `prototype`. This can lead to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "jatidevelopments/MCP-Puppeteer-Advanced-Cursor-...-",
      "file_path": "index.ts.bak",
      "url": "https://github.com/jatidevelopments/MCP-Puppeteer-Advanced-Cursor-...-/blob/4d037837c85bc31e51a960fca7062af2081293fb/index.ts.bak",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 48,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function uses 'Object.assign' and iterates over keys of the 'source' object without validating them. If 'source' contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution. The lack of safeguards against merging user-controlled data makes this code highly suspicious."
      }
    },
    {
      "repository": "soumyadip007/PHP-JS-Basics-Architecture-Form-CURD-Registration-Login",
      "file_path": "Projects/Bubble Game/js/utils.js",
      "url": "https://github.com/soumyadip007/PHP-JS-Basics-Architecture-Form-CURD-Registration-Login/blob/5261e1e13362896b322e8207e9f2cc4f7c6e528b/Projects/Bubble%20Game/js/utils.js",
      "language": "javascript",
      "stars": 70,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges properties from a user-controlled 'source' object into a 'target' object without validating the property names. This can allow an attacker to manipulate the prototype of an object by including properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "luqin/systemjs-starter-kit",
      "file_path": "public/assets/echarts/util/ecQuery.js",
      "url": "https://github.com/luqin/systemjs-starter-kit/blob/9c61163504a7d6333a887a22e26f567d0fa3fe40/public/assets/echarts/util/ecQuery.js",
      "language": "javascript",
      "stars": 35,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code uses a merging function (zrUtil.merge) that does not validate property names before merging user-controlled data into objects. If any of the objects in ctrList contain properties like '__proto__', 'constructor', or 'prototype', this could lead to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "kiranshahi/Click-Copy-Code",
      "file_path": "snippets.js",
      "url": "https://github.com/kiranshahi/Click-Copy-Code/blob/4cebd89174217918169d3e01206e50a51d31ef89/snippets.js",
      "language": "javascript",
      "stars": 5,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges properties from the 'source' object into the 'target' object without validating the property names. This allows an attacker to potentially set dangerous properties like '__proto__', 'constructor', or 'prototype', leading to prototype pollution."
      }
    },
    {
      "repository": "KokanP/ChickenClicker",
      "file_path": "script.js",
      "url": "https://github.com/KokanP/ChickenClicker/blob/e6b06db3a043c89214501ec91b51903648dca6d3/script.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges properties from a user-controlled 'source' object into a 'target' object without validating the property names. This allows an attacker to potentially set dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "hbyunzai/yelon-builds",
      "file_path": "@yelon/util/fesm2022/other.mjs",
      "url": "https://github.com/hbyunzai/yelon-builds/blob/ec22712ae5e467d26998b78d74370b8cf44610f7/@yelon/util/fesm2022/other.mjs",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The `deepMergeKey` function merges objects without sufficient validation of property names. Although it filters out the '__proto__' property, it does not prevent other dangerous properties like 'constructor' or 'prototype' from being merged. This allows an attacker to potentially manipulate the prototype of objects, leading to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "leecade/echarts",
      "file_path": "amd/util/ecQuery.js",
      "url": "https://github.com/leecade/echarts/blob/3cf52a6ee8d133f34d5f87098a69d167c1e3513c/amd/util/ecQuery.js",
      "language": "javascript",
      "stars": 6,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code uses the `zrUtil.merge` function, which is likely an unsafe extend/merge function that does not validate property names. If user-controlled data is passed into `ctrList` or `optionLocation`, it could lead to the assignment of dangerous properties like '__proto__', allowing for prototype pollution."
      }
    },
    {
      "repository": "love320/Zdocker",
      "file_path": "src/main/webapp/js/echarts/util/ecQuery.js",
      "url": "https://github.com/love320/Zdocker/blob/8a360d962791d7f8a9f23b7c4bed84832d216911/src/main/webapp/js/echarts/util/ecQuery.js",
      "language": "javascript",
      "stars": 10,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code uses a merging function (zrUtil.merge) without validating property names, which can lead to prototype pollution if user-controlled data is merged into objects. Specifically, if any of the properties in 'ctrList' contain keys like '__proto__', 'constructor', or 'prototype', it could allow an attacker to modify the prototype of Object, leading to potential security issues."
      }
    },
    {
      "repository": "ivruhs/JobVector",
      "file_path": "server/services/skillExtractor.js",
      "url": "https://github.com/ivruhs/JobVector/blob/4fbd52dbf59ebe5ececefec06e3f705b258afb85/server/services/skillExtractor.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The deepMerge function does not validate property names before merging the source object into the target object. This allows an attacker to manipulate the source object to include properties like '__proto__', which can lead to prototype pollution."
      }
    },
    {
      "repository": "mishkah-os/fw",
      "file_path": "mishkah-utils.js",
      "url": "https://github.com/mishkah-os/fw/blob/1252b885faf70640729e23d7444b27319d4a6d3d/mishkah-utils.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 51,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function 'cloneConfig' attempts to clone an object using 'JSON.parse(JSON.stringify(source))'. If 'source' contains user-controlled data, it can lead to prototype pollution if the object has properties like '__proto__' or 'constructor'. This is particularly dangerous as it allows an attacker to manipulate the prototype of built-in objects."
      }
    },
    {
      "repository": "Varo-Saran/Vathsaran-Portfolio",
      "file_path": "assets/js/script.js",
      "url": "https://github.com/Varo-Saran/Vathsaran-Portfolio/blob/3bf63e4abd694756da19133037637754d1436dd9/assets/js/script.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The function 'deepMerge' merges objects without validating property names. If user-controlled data is passed to 'themeConfigs', it could allow for prototype pollution by assigning to properties like '__proto__' or 'constructor'. Although the source of 'themeConfigs' is not directly user-controlled in the provided snippet, the lack of validation in the merging process poses a risk if this code is adapted or if 'themeConfigs' can be influenced by external input."
      }
    },
    {
      "repository": "acro5piano/mcp-auto-browser",
      "file_path": "index.ts",
      "url": "https://github.com/acro5piano/mcp-auto-browser/blob/499428ee084aa89c4b466913779f4b9da53cf956/index.ts",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The deepMerge function merges objects without validating property names, which can allow user-controlled data to overwrite sensitive properties like __proto__, constructor, or prototype. This poses a significant risk for prototype pollution."
      }
    },
    {
      "repository": "claraa39/pitchAccentExp2024",
      "file_path": "jspsych/jspsych.js",
      "url": "https://github.com/claraa39/pitchAccentExp2024/blob/539d8982daeadc48bddfa8dc085c33f3df765a6f/jspsych/jspsych.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges two objects recursively without validating property names. If user-controlled data is passed as 'obj2', it could allow assignment to dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "NPM365/echarts2",
      "file_path": "util/ecQuery.js",
      "url": "https://github.com/NPM365/echarts2/blob/e609cf113ddc7a88b0967a486f884f076de0ee5f/util/ecQuery.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code uses the `zrUtil.merge` function, which appears to merge properties from one object into another without validating the property names. If user-controlled data is passed to `deepMerge`, it could potentially allow for the assignment of dangerous properties like '__proto__', leading to prototype pollution."
      }
    },
    {
      "repository": "marek1n/rc-fair23",
      "file_path": "static/jspsych/jspsych.js",
      "url": "https://github.com/marek1n/rc-fair23/blob/18160db5a13eae7f909128a3994253e26965b562/static/jspsych/jspsych.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges two objects recursively without validating property names. If 'obj2' contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution by modifying the prototype of the object being merged into."
      }
    },
    {
      "repository": "aaltenhof/synonymous_borrowing",
      "file_path": "jspsych/jspsych.js",
      "url": "https://github.com/aaltenhof/synonymous_borrowing/blob/bf70bf82a7dd5333647260001167f2e6dd85bf43/jspsych/jspsych.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code merges properties from obj1 and obj2 into the merged object without validating the property names. If user-controlled data is passed into obj1 or obj2, it could allow for the assignment of dangerous properties like __proto__, leading to prototype pollution."
      }
    },
    {
      "repository": "dustpickle/intendr-chat",
      "file_path": "chatembed.js",
      "url": "https://github.com/dustpickle/intendr-chat/blob/498d0b4c97930e9832a2de60ba7ae64aa5ca5d44/chatembed.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function merges properties from the 'source' object into the 'target' object without validating the property names. If 'source' contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution. The function does not check for these dangerous properties before merging, making it vulnerable."
      }
    },
    {
      "repository": "code-craka/puppeteer-mcp",
      "file_path": "index.ts",
      "url": "https://github.com/code-craka/puppeteer-mcp/blob/10693545cf1defcac469a69375199a8e570cbf6e/index.ts",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The 'deepMerge' function uses 'Object.assign' to merge objects without validating property names. If the 'source' object contains properties like '__proto__', 'constructor', or 'prototype', it can lead to prototype pollution. Additionally, if user-controlled data is passed as 'source', it can be exploited."
      }
    },
    {
      "repository": "Jaaap/SQRL",
      "file_path": "bn.js",
      "url": "https://github.com/Jaaap/SQRL/blob/e52dabc3f6d38c6664e54f84025420db3cb92844/bn.js",
      "language": "javascript",
      "stars": 64,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The code contains methods that manipulate objects without validating property names, particularly in functions like `iadd`, `isub`, and others that modify the internal state of the `BN` object. If user-controlled data is passed to these methods, it could allow an attacker to modify the prototype of objects, leading to potential security issues."
      }
    },
    {
      "repository": "dleppik/ozone",
      "file_path": "ozone.d.ts",
      "url": "https://github.com/dleppik/ozone/blob/112798cff00d0cbd535ff1e165144573eaa9306b/ozone.d.ts",
      "language": "typescript",
      "stars": 15,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.8,
        "explanation": "The provided TypeScript code snippet does not contain any direct operations that would lead to prototype pollution. However, without seeing the implementations of the functions 'mergeFieldDescriptors' and 'convert', we cannot fully rule out the possibility of prototype pollution if they involve unsafe merging or extending of objects. The confidence level is moderate due to the lack of context on these implementations."
      }
    },
    {
      "repository": "supnate/single",
      "file_path": "s.js",
      "url": "https://github.com/supnate/single/blob/ac8cdce5e8713e04f21f3874a1dca93bc6639801/s.js",
      "language": "javascript",
      "stars": 6,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.8,
        "explanation": "The provided code snippet does not directly exhibit prototype pollution vulnerabilities. It does not show any unsafe merging or extending of objects, nor does it involve user-controlled data being merged into objects without validation. However, the context of how data is handled in the broader application is not provided, which affects the confidence level."
      }
    },
    {
      "repository": "tonyg/synchrotron",
      "file_path": "mc.js",
      "url": "https://github.com/tonyg/synchrotron/blob/2811d9b51193a84e3cc12061fe2fe53d4474419f/mc.js",
      "language": "javascript",
      "stars": 44,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The code does not appear to directly manipulate object prototypes or merge user-controlled data into objects without validation. However, it uses various merge functions (e.g., `Mc.ObjectTypes.simpleScalar.merge` and `Mc.ObjectTypes.rawObject.merge`) whose implementations are not provided. If these functions do not validate property names or handle user input safely, there could be a risk of prototype pollution. Without visibility into those implementations, the overall risk remains uncertain."
      }
    },
    {
      "repository": "stevengill/coho",
      "file_path": "coho",
      "url": "https://github.com/stevengill/coho/blob/9cf0fe8c7283f11cc3408c3c42005acd3dd9fbbe/coho",
      "language": "javascript",
      "stars": 6,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The provided code snippet does not contain any direct merging of user-controlled data into objects or unsafe property assignments that could lead to prototype pollution. It primarily deals with repository cloning and does not exhibit patterns associated with prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "onlykey/onlykey.github.io",
      "file_path": "past_releases/Beta8/src/ecc.js",
      "url": "https://github.com/onlykey/onlykey.github.io/blob/ab12e1e2f8f10a67fe45227162fe305ca539ccb9/past_releases/Beta8/src/ecc.js",
      "language": "javascript",
      "stars": 23,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The code does not appear to merge or extend objects with user-controlled data in a way that would allow prototype pollution. It uses strict assertions and type checks to ensure that inputs are valid, and there are no direct assignments to dangerous properties like __proto__, constructor, or prototype."
      }
    },
    {
      "repository": "ohanhi/polymer-in-elm",
      "file_path": "elm.js",
      "url": "https://github.com/ohanhi/polymer-in-elm/blob/9ff1fd3afdfc8ec772bb060348fe96a87e7fdc4d/elm.js",
      "language": "javascript",
      "stars": 16,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The code does not appear to merge or extend objects using user-controlled data without validation. It primarily uses internal functions and structures without exposing any direct means for prototype pollution. However, without further context on how the `localRuntime` object is constructed or populated, there remains a slight uncertainty."
      }
    },
    {
      "repository": "jennyguidetti/OpenFlight_analysis",
      "file_path": "A2.js",
      "url": "https://github.com/jennyguidetti/OpenFlight_analysis/blob/bed72f729a7def808dd47a41c568edde870fd44e/A2.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        }
      ],
      "vulnerability_count": 53,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The code snippet does not merge or extend objects using user-controlled data. It constructs a new object based on the properties of the flight and airport data without any unsafe operations that could lead to prototype pollution."
      }
    },
    {
      "repository": "MRID0007/UnweavingTheWeb2",
      "file_path": "FAM.js",
      "url": "https://github.com/MRID0007/UnweavingTheWeb2/blob/8affb3d7d2f4c3e13163148613eb6ceba65dc82e/FAM.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The code does not directly manipulate object properties in a way that would allow for prototype pollution. It primarily deals with arrays and string manipulations without merging user-controlled data into objects. However, there is a potential risk if `merges` or `currentFA` could be influenced by untrusted input, but this is not evident in the provided snippet."
      }
    },
    {
      "repository": "gptlint/gptlint",
      "file_path": "src/utils.ts",
      "url": "https://github.com/gptlint/gptlint/blob/bcd5808aeb04d8e746f6731077a386ec564af50e/src/utils.ts",
      "language": "typescript",
      "stars": 283,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The provided code snippet does not include any merging or extending of objects with user-controlled data, nor does it involve the use of unsafe functions like JSON.parse or direct assignments to dangerous properties. The function simply sums numeric properties of two objects of a defined type, which does not present a prototype pollution risk."
      }
    },
    {
      "repository": "mitranim/atril",
      "file_path": "src/utils.ts",
      "url": "https://github.com/mitranim/atril/blob/c38b0750d77c59018a1b783c667adf0e2ad547da/src/utils.ts",
      "language": "typescript",
      "stars": 13,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The provided code snippet does not contain any direct assignments to prototype properties or unsafe merging of user-controlled data. The functions shown do not manipulate object properties in a way that would lead to prototype pollution vulnerabilities."
      }
    },
    {
      "repository": "ganeshkbhat/ejson",
      "file_path": "index.ts",
      "url": "https://github.com/ganeshkbhat/ejson/blob/28641c6bca497561cd941db362f87bdf86661186/index.ts",
      "language": "typescript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.9,
        "explanation": "The function merges properties from object 'u' into object 'l' without validating the property names. If 'u' contains properties like '__proto__', it can lead to prototype pollution by modifying the prototype of all objects. The lack of checks on property names makes this code highly susceptible to such vulnerabilities."
      }
    },
    {
      "repository": "Pinta365/type-detective",
      "file_path": "mod.ts",
      "url": "https://github.com/Pinta365/type-detective/blob/d625a0cd318ec85b4ca2d5598a78a0519f859ffe/mod.ts",
      "language": "typescript",
      "stars": 2,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.8,
        "explanation": "The provided code snippet does not show any direct signs of prototype pollution vulnerabilities. The functions appear to handle type strings and object merging without any indication of merging user-controlled data into objects or unsafe property assignments. However, the analysis is limited to the visible snippet, and further context may be needed to fully assess the risk."
      }
    },
    {
      "repository": "olivia-tran/typescript-ot",
      "file_path": "index.ts",
      "url": "https://github.com/olivia-tran/typescript-ot/blob/8a86ad2987f3187a5d38aa3ae35c93e15362b3c0/index.ts",
      "language": "typescript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 54,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The merge function uses object spread syntax to combine two objects, which does not inherently lead to prototype pollution as long as the input objects are controlled and do not contain dangerous property names. However, the code does not validate the properties of the input objects, which could be a concern if user-controlled data were to be merged. In the current state, it appears safe, but caution should be taken if the inputs are not strictly controlled."
      }
    },
    {
      "repository": "automerge/automerge-classic",
      "file_path": "backend/new.js",
      "url": "https://github.com/automerge/automerge-classic/blob/0605308926a03353eb1072c3afa2a3a8580fcef9/backend/new.js",
      "language": "javascript",
      "stars": 14726,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDocChangeOps' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const firstOp = changeState.nextOp, insert = firstOp[insertIdx]\n  const objActor = firstOp[objActorIdx], objCtr = firstOp[objCtrIdx]\n  const objectId = objActor === null ? '_root' : `${objCtr}@${docState.actorIds[objActor]}`\n  const idActorIndex = changeState.actorIndex, idActor = docState.actor",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 55,
      "llm_analysis": {
        "is_vulnerable": true,
        "confidence": 0.8,
        "explanation": "The code merges operations from user-controlled inputs (changeOps) into document operations without validating property names. If any operation contains properties like '__proto__', it could lead to prototype pollution, allowing an attacker to manipulate the prototype of objects in the application."
      }
    },
    {
      "repository": "firebase/firebase-js-sdk",
      "file_path": "packages/util/src/deepCopy.ts",
      "url": "https://github.com/firebase/firebase-js-sdk/blob/e6415ddee915e5c4dc6ef323fd717ce254f63c51/packages/util/src/deepCopy.ts",
      "language": "typescript",
      "stars": 5043,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDocChangeOps' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const firstOp = changeState.nextOp, insert = firstOp[insertIdx]\n  const objActor = firstOp[objActorIdx], objCtr = firstOp[objCtrIdx]\n  const objectId = objActor === null ? '_root' : `${objCtr}@${docState.actorIds[objActor]}`\n  const idActorIndex = changeState.actorIndex, idActor = docState.actor",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 55,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.8,
        "explanation": "The code snippet does not show any direct assignment to dangerous properties like __proto__, constructor, or prototype. It also includes a note indicating that __proto__ is not merged to prevent prototype pollution. However, without seeing the complete implementation of the deepExtend function, especially how it handles merging properties recursively, there is a moderate level of uncertainty."
      }
    },
    {
      "repository": "kijiramer/AppBTP-Backend",
      "file_path": ".debris/2024-06-27/deepCopy.d.ts",
      "url": "https://github.com/kijiramer/AppBTP-Backend/blob/9913f6e7c4c95cc1757cf257559fc47e4a69a432/.debris/2024-06-27/deepCopy.d.ts",
      "language": "typescript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDocChangeOps' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const firstOp = changeState.nextOp, insert = firstOp[insertIdx]\n  const objActor = firstOp[objActorIdx], objCtr = firstOp[objCtrIdx]\n  const objectId = objActor === null ? '_root' : `${objCtr}@${docState.actorIds[objActor]}`\n  const idActorIndex = changeState.actorIndex, idActor = docState.actor",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 55,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The function deepExtend is declared to prevent merging of the __proto__ property, which is a common vector for prototype pollution. However, without the implementation details, it's unclear if other unsafe merging practices are employed. The confidence level is high due to the explicit note about __proto__."
      }
    },
    {
      "repository": "skutac/ChemSpace.js",
      "file_path": "chemspace_dev.js",
      "url": "https://github.com/skutac/ChemSpace.js/blob/ec460d80d34ecebcb6379045cc73823db1337a99/chemspace_dev.js",
      "language": "javascript",
      "stars": 1,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDocChangeOps' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const firstOp = changeState.nextOp, insert = firstOp[insertIdx]\n  const objActor = firstOp[objActorIdx], objCtr = firstOp[objCtrIdx]\n  const objectId = objActor === null ? '_root' : `${objCtr}@${docState.actorIds[objActor]}`\n  const idActorIndex = changeState.actorIndex, idActor = docState.actor",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 55,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.9,
        "explanation": "The function checks if an object is mergeable by ensuring it is an object and not a RegExp or Date. However, it does not perform any merging or extending of objects, so there is no direct prototype pollution vulnerability present in this snippet."
      }
    },
    {
      "repository": "ko52/javascript_coding",
      "file_path": "01-fundamentals/exercises.js",
      "url": "https://github.com/ko52/javascript_coding/blob/2f5b385d23ec69c83248cf417d80a5a1e33e8be7/01-fundamentals/exercises.js",
      "language": "javascript",
      "stars": 0,
      "vulnerabilities": [
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'protoPollution' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n  // VULN: V012 — Prototype Pollution — merge JSON with __proto__ into target options\n  const raw = SRC.json(); // e.g. {\"__proto__\":{\"pwned\":true}}\n  if (!raw) return;\n  try {\n    const user = JSON.parse(raw); // SOURCE\n    const defaults = { safe: true };\n    // naive deep merge\n    function dee",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      for (const k in s) {\n        if (s[k] && typeof s[k] === 'object') t[k] = deepMerge(t[k] || {}, s[k]);\n        else t[k] = s[k];\n      }\n      return t;\n    }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'unique_name_33' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{ 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function '_defineProperties' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descrip",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 28,
          "column": 2,
          "message": "Function '_arrayLikeToArray' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 205,
          "column": 2,
          "message": "Function 'resolveUrl' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n     ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 241,
          "column": 2,
          "message": "Function 'merge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 259,
          "column": 2,
          "message": "Function 'splitCells' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        esc",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 452,
          "column": 33,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n           ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 531,
          "column": 21,
          "message": "Function 'nptable' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/,",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 712,
          "column": 17,
          "message": "Function 'def' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: c",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 727,
          "column": 19,
          "message": "Function 'table' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 841,
          "column": 18,
          "message": "Function 'link' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n         ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1063,
          "column": 17,
          "message": "Function 'url' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1367,
          "column": 29,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options =",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1434,
          "column": 25,
          "message": "Function 'blockTokens' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1597,
          "column": 20,
          "message": "Function 'inline' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2068,
          "column": 31,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2085,
          "column": 29,
          "message": "Function 'getNextSafeSlug' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2568,
          "column": 15,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2572,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key+",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2575,
          "column": 20,
          "message": "Function '_loop' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].ap",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2578,
          "column": 27,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2602,
          "column": 7,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 <",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2605,
          "column": 21,
          "message": "Function '_loop2' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokeni",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 2608,
          "column": 28,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = pr",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'RevealAce' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if(!Reveal.ace) Reveal.ace = {};\n  function extend(o) {\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  };\n  function mkEditor(iframe) {\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE h",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 3,
          "column": 2,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    for(var i = 1; i < arguments.length; i++)\n      for(var key in arguments[i])\n        o[key] = arguments[i][key];\n    return o;\n  }",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 9,
          "column": 2,
          "message": "Function 'mkEditor' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    var w = iframe.contentWindow, d = w.document;\n    d.write(\"<!DOCTYPE html><html>\"+\n      \"<head>\"+\n      \"<script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.9/ace.js' type='text/javascript' charset='utf-8'></script>\"+\n      \"</head>\"+\n      \"<body>\"+\n      \"<div id='editor' style='pos",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 21,
          "column": 20,
          "message": "Function '(anonymous)' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n      function slidechanged(event) {\n        var e = iframe;\n        for(var e = iframe; e && e != event.currentSlide; e = e.parentNode);\n        if(!e)\n          return;\n        iframe.focus();\n        editor.focus();\n      }\n      var editor = w.ace.edit(d.getElementById('editor'));\n      var ac",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'extend' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    if(prefix) { // rename prototype properties\n        for(var k in base.prototype) {\n            Object.defineProperty(\n                base.prototype,\n                prefix+\"_\"+k,\n                Object.getOwnPropertyDescriptor(base.prototype, k));\n            delete base.prototype[k];\n       ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "high",
          "line": 12,
          "column": 4,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype = Object.create(base.prototype)",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 13,
          "column": 33,
          "message": "Direct assignment to dangerous property 'prototype'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype[key] = origProto[key]",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "high",
          "line": 14,
          "column": 4,
          "message": "Direct assignment to dangerous property 'constructor'. This could lead to prototype pollution.",
          "code_snippet": "sub.prototype.constructor = sub",
          "type": "direct_dangerous_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDeep' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (!target[key]) {\n          Object.assign(target, { [key]: {} });\n        }\n        mergeDeep(target[key], source[key]);\n      } else {\n        target[key] = source[key];\n    ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeAllowDenyDetails' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    let detail1Keys = Object.keys (detail1);\n    let detail2Keys = Object.keys (detail2);\n    let tmp={};\n    for (let key of detail1Keys){\n        tmp[key] = [...detail1[key], ...detail2Keys.includes(key)?detail2[key]:[]];\n        tmp[key]= [...new Set(tmp[key])];\n    }\n\n    for (let key of detai",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n\tlet src\n\n\twhile (true) {\n\n\t\tif (!sources.length)\n\n\t\t\treturn target\n\n\t\tsrc = sources.shift()\n\n\t\tif (src)\n\n\t\t\tbreak\n\n\t}\n\n\n\n\tfor (let k in src) {\n\n\n\n\t\tlet v = src[k]\n\n\t\tlet existing = target[k]\n\n\n\n\t\tif (typeof v === 'object') {\n\n\t\t\tif (v === null) {\n\n\t\t\t\ttarget[k] = null\n\n\t\t\t} else if (Array.isArra",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (isObject(base) && isObject(extension)) {\n    for (const key in extension) {\n      if (isObject(extension[key])) {\n        if (!base[key]) base[key] = {};\n        deepMerge(base[key], extension[key]);\n      } else {\n        Object.assign(base, {[key]: extension[key]});\n      }\n    }\n  }\n  ret",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\tif (obj === null || typeof obj != \"object\") return obj;\n\tvar copy, i, len;\n\tif (obj instanceof Date) {\n\t\tcopy = new Date();\n\t\tcopy.setTime(obj.getTime());\n\t\treturn copy;\n\t}\n\tif (obj instanceof Array) {\n\t\tcopy = [];\n\t\tfor (i = 0, len = obj.length; i < len; ++i)\n\t\t\tcopy[i] = clone(obj[i]);\n\t\treturn",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!isObject(target) || !isObject(source)) return source;\n  const output = { ...target };\n  for (const key in source) {\n    if (isObject(source[key])) {\n      output[key] = key in target ? deepMerge(target[key], source[key]) : source[key];\n    } else {\n      output[key] = source[key];\n    }\n  }",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  for (let key in source) {\n    if (\n      typeof source[key] === \"object\" &&\n      source[key] !== null &&\n      !Array.isArray(source[key])\n    ) {\n      if (!target[key]) target[key] = {};\n      deepMerge(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  }\n  retur",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    let target = {};\n\n\n\n    function merger(obj) {\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n       ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 7,
          "column": 4,
          "message": "Function 'merger' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (let prop in obj) {\n\n            if (obj.hasOwnProperty(prop)) {\n\n                if (Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\n                    target[prop] = deepMerge(target[prop], obj[prop]);\n\n                }\n\n                else {\n\n                ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    const result = { ...target };\n    \n    for (let key in source) {\n        if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n            result[key] = deepMerge(result[key] || {}, source[key]);\n        } else {\n            result[key] = source[key];\n        }\n ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const result = { ...defaults };\n\n  // Handle invalid userTokens\n  if (\n    !userTokens ||\n    typeof userTokens !== \"object\" ||\n    Array.isArray(userTokens)\n  ) {\n    return result;\n  }\n\n  for (const key in userTokens) {\n    if (userTokens.hasOwnProperty(key)) {\n      if (\n        typeof userTo",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  if (!src) return target;\n  for (var k in src) if (src.hasOwnProperty(k)){\n    if (typeof src[k]===\"object\" && src[k]!==null && !(src[k] instanceof Array)){\n      if (typeof target[k]!==\"object\" || target[k]===null) target[k]={};\n      deepMerge(target[k], src[k]);\n    } else target[k]=src[k];\n  ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "high",
          "line": 1,
          "column": 0,
          "message": "Function 'deepMerge' receives data from json_parse source and performs property copying/merging without validating dangerous properties. This creates a prototype pollution vulnerability.",
          "code_snippet": "{\n    if (clone) {\n        obj1 = JSON.parse(JSON.stringify(obj1));\n        obj2 = JSON.parse(JSON.stringify(obj2));\n    }\n    Object.keys(obj2).forEach((key) => {\n        if (obj2[key] instanceof Object && obj1[key] instanceof Object) {\n            obj1[key] = deepMerge(obj1[key], obj2[key]);\n     ",
          "type": "source_to_sink_pollution"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'clone_image_region' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  var r1 = new file_region();\n\n  // copy shape attributes\n  for ( var key in r0.shape_attributes ) {\n    r1.shape_attributes[key] = clone_value(r0.shape_attributes[key]);\n  }\n\n  // copy region attributes\n  for ( var key in r0.region_attributes ) {\n    r1.region_attributes[key] = clone_value(r0.reg",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'Utils' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\"use strict\";\n\n\tvar publicAPI,\n\t\tdigits;\n\n\t// polyfill ES6 `Math.sign`\n\tif (!Math.sign) {\n\t\tMath.sign = function sign(x) {\n\t\t\tx = Number(x);\n\t\t\tif (!x) return x;\n\t\t\treturn x < 0 ? -1 : 1;\n\t\t};\n\t}\n\n\tdigits = {\n\t\t\"small\": null,\n\t\t\"big\": null,\n\t};\n\n\tpublicAPI = {\n\t\tloadImgOnEntry: loadImgOnEntry,\n\t\t",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 137,
          "column": 1,
          "message": "Function 'cacheScaledDigits' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (!digits[textType]) {\n\t\t\tdigits[textType] = Text.getText(textType,\"0123456789\",[]);\n\t\t}\n\n\t\tfor (var i=0; i<=9; i++) {\n\t\t\tvar digit = String(i);\n\t\t\tvar cacheItem = Text.getCachedCharacter(cacheIDPrefix + \":\" + digit);\n\t\t\tvar digitImg = digits[textType][i];\n\t\t\tvar digitWidth = Math.ceil(digitIm",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 175,
          "column": 1,
          "message": "Function 'mergeSlot' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\t\tif (target && typeof target == \"object\") {\n\t\t\tif (typeof source[key] == \"object\") {\n\t\t\t\tif (!(key in target)) {\n\t\t\t\t\ttarget[key] = Array.isArray(source[key]) ? [] : {};\n\t\t\t\t}\n\n\t\t\t\tdeepMerge(target[key],source[key]);\n\t\t\t}\n\t\t\telse if (!(key in target)) {\n\t\t\t\ttarget[key] = source[key];\n\t\t\t}\n\t\t}\n\t}",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'updateParticlesForTheme' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n    if (typeof particlesJS === 'undefined') return;\n\n\n\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';\n\n    const baseConfig = {\n\n        particles: {\n\n            number: { value: 120, density: { enable: true, value_area: 800 } },\n\n            shape: { typ",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 89,
          "column": 4,
          "message": "Function 'deepMerge' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n\n        for (const key in source) {\n\n            if (source.hasOwnProperty(key)) {\n\n                if (typeof source[key] === 'object' && source[key] !== null && target[key]) {\n\n                    deepMerge(target[key], source[key]);\n\n                } else {\n\n                    target[key] = ",
          "type": "vulnerable_recursive_merge"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeStates' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n    feedback.innerHTML = \"\";\n    let guess = mergeGuessField.value.split(' ').sort();\n    for (let i=0; i<guess.length; i++) {\n        guess[i] = parseInt(guess[i]);\n    }\n    merges = findGroups(true);\n\n    if (Object.keys(merges).length == 0) {\n        feedback.innerText = \"No more merging is po",
          "type": "vulnerable_property_assignment"
        },
        {
          "severity": "medium",
          "line": 1,
          "column": 0,
          "message": "Function 'mergeDocChangeOps' performs property copying/merging without validating dangerous properties (__proto__, constructor, prototype). This makes it vulnerable to prototype pollution attacks.",
          "code_snippet": "{\n  const firstOp = changeState.nextOp, insert = firstOp[insertIdx]\n  const objActor = firstOp[objActorIdx], objCtr = firstOp[objCtrIdx]\n  const objectId = objActor === null ? '_root' : `${objCtr}@${docState.actorIds[objActor]}`\n  const idActorIndex = changeState.actorIndex, idActor = docState.actor",
          "type": "vulnerable_property_assignment"
        }
      ],
      "vulnerability_count": 55,
      "llm_analysis": {
        "is_vulnerable": false,
        "confidence": 0.8,
        "explanation": "The function 'deepMerge' is defined but not implemented, making it impossible to determine if it is vulnerable to prototype pollution. However, if it were to merge objects without validating property names or handling dangerous properties, it could potentially be vulnerable. The confidence level reflects the lack of implementation details."
      }
    }
  ],
  "total_vulnerabilities": 4226,
  "vulnerabilities_by_type": {
    "source_to_sink_pollution": 159,
    "vulnerable_recursive_merge": 830,
    "vulnerable_property_assignment": 2991,
    "direct_dangerous_property_assignment": 246
  },
  "vulnerabilities_by_severity": {
    "high": 405,
    "medium": 3821,
    "low": 0
  },
  "llm_summary": "### Summary of Prototype Pollution Vulnerabilities\n\n1. **Total Number of Vulnerabilities Found**: 36 vulnerabilities across 15 different repositories.\n\n2. **Most Common Vulnerability Types**:\n   - **Source to Sink Pollution**: 12 occurrences (high severity)\n   - **Vulnerable Recursive Merge**: 12 occurrences (medium severity)\n   - **Vulnerable Property Assignment**: 4 occurrences (medium severity)\n\n3. **Most Critical Findings**:\n   - **High Severity Vulnerabilities**: Identified in multiple repositories, particularly in functions named `protoPollution`, which allow property copying/merging without validating dangerous properties. Affected repositories include:\n     - `cognizanthackathon10/Final_Commit_1`\n     - `hex2f/windevRant`\n     - `EleanorMao/FlexoCalendar.js`\n     - `EGreg/Q.js`\n     - `devin87/Q.js`\n     - `newslin-design/newslin-design.github.io`\n     - `jscriptcoder/sandbox-architecture`\n     - `codefornl/AfvalStoffenWeb`\n     - `SrMatheus2000/fixed-vuln-test`\n\n4. **Recommendations**:\n   - **Input Validation**: Implement strict validation for inputs in functions that perform property copying or merging to prevent prototype pollution.\n   - **Sanitize Dangerous Properties**: Explicitly check for and sanitize or block properties such"
}