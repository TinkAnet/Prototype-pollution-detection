<!DOCTYPE html>
<html>
<head>
    <title>Mixed HTML/JS Example</title>
</head>
<body>
    <h1>Prototype Pollution Test - Example 3</h1>
    
    <!-- Source: Multiple data attributes -->
    <div id="app-config" 
         data-settings='{"__proto__": {"polluted": "test"}}'
         data-options='{"theme": "dark"}'>
        App Configuration
    </div>
    
    <form id="user-form">
        <input type="text" id="user-input" placeholder="Enter JSON config">
        <button type="button" onclick="processInput()">Process</button>
    </form>
    
    <script src="utils.js"></script>
    <script src="vulnerable.js"></script>
    <script>
        // Inline script connecting source to sink
        function processInput() {
            // SOURCE: Get user input
            var userInput = document.getElementById('user-input').value;
            var userConfig = JSON.parse(userInput);  // SOURCE: JSON.parse
            
            // SOURCE: Get from DOM attribute
            var element = document.querySelector('#app-config');
            var settings = JSON.parse(element.getAttribute('data-settings'));  // SOURCE
            
            // SINK: Merge configurations
            var defaultConfig = {};
            extend(defaultConfig, userConfig);  // SINK: Receives from source
            extend(defaultConfig, settings);    // SINK: Receives from source
            
            console.log('Merged config:', defaultConfig);
        }
    </script>
</body>
</html>

